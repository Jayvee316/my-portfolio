<section class="projects-section">
  <h2>My Projects</h2>
  <p class="section-description">
    Here are some of the projects I've built using modern Angular features.
  </p>
  
  <!-- Search Box -->
  <div class="search-container">
    <input
      type="text"
      class="search-input"
      placeholder="Search projects by name, description, or technology..."
      [(ngModel)]="searchTerm"
      aria-label="Search projects">

    <!-- Clear button - only show if there's text -->
    @if (searchTerm()) {
      <button
        class="clear-btn"
        (click)="clearSearch()"
        aria-label="Clear search"
        type="button">
        ‚úï
      </button>
    }
  </div>
  
  <!-- Results count -->
  <p class="results-info">
    Showing {{ filteredProjects().length }} of {{ allProjects().length }} projects
  </p>
  
  <!-- Projects Grid -->
  @if (filteredProjects().length > 0) {
    <div class="projects-grid">
      @for (project of filteredProjects(); track project.id) {
        <div class="project-card">
          <h3>{{ project.title }}</h3>
          <p class="description">{{ project.description }}</p>
          
          <div class="technologies">
            <strong>Technologies:</strong>
            @for (tech of project.technologies; track tech) {
              <span class="tech-badge">{{ tech }}</span>
            }
          </div>

          <!-- Star Rating using model() -->
          <div class="project-rating">
            <span class="rating-label">Your Rating:</span>
            <app-star-rating
              [rating]="project.rating"
              (ratingChange)="onRatingChange(project.id, $event)"
              [maxStars]="5"
              [showLabel]="true"
            />
          </div>

          <div class="project-links">
            @if (project.githubLink) {
              <a [href]="project.githubLink" target="_blank" class="btn">
                <span>üìÅ</span> GitHub
              </a>
            }
            @if (project.liveLink) {
              <a [href]="project.liveLink" target="_blank" class="btn btn-primary">
                <span>üöÄ</span> Live Demo
              </a>
            }
            <!-- Delete button to demo ConfirmDialog -->
            <button class="btn btn-delete" (click)="onDeleteClick(project)">
              <span>üóëÔ∏è</span> Delete
            </button>
          </div>
        </div>
      }
    </div>
  } @else {
    <!-- No results message -->
    <div class="no-results">
      <h3>No projects found</h3>
      <p>Try searching for "Angular", "Firebase", or "Dashboard"</p>
      <button class="btn btn-primary" (click)="clearSearch()">
        Clear Search
      </button>
    </div>
  }

  <!--
    ConfirmDialog using input() and output()

    INPUTS (data flowing IN):
    - [title] = dialog title
    - [message] = dialog message
    - [confirmText] = confirm button text
    - [cancelText] = cancel button text
    - [type] = 'default' | 'danger' | 'warning'

    OUTPUTS (events flowing OUT):
    - (confirmed) = user clicked confirm
    - (cancelled) = user clicked cancel or backdrop
  -->
  @if (showDeleteDialog()) {
    <app-confirm-dialog
      [title]="'Delete Project'"
      [message]="deleteMessage()"
      [confirmText]="'Delete'"
      [cancelText]="'Cancel'"
      [type]="'danger'"
      (confirmed)="onDeleteConfirmed()"
      (cancelled)="onDeleteCancelled()"
    />
  }
</section>